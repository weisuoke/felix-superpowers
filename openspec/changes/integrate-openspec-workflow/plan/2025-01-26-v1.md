# Integrate Superpowers Skills with OpenSpec Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**OpenSpec Change:** `openspec/changes/integrate-openspec-workflow/`

**Goal:** Integrate brainstorming, writing-plans, and executing-plans skills with OpenSpec change workflow to create a unified pipeline from ideation to implementation.

**Architecture:** Modify three existing skill files to add OpenSpec integration. brainstorming creates change structure, writing-plans reads context and outputs to plan/, executing-plans syncs tasks.md status.

**Tech Stack:** Markdown skill files, OpenSpec directory conventions

---

### Task 1: Modify brainstorming skill - Add OpenSpec prompt flow

**Files:**
- Modify: `skills/brainstorming/SKILL.md:35-46`

**Step 1: Read current "After the Design" section**

Current content to replace (lines 35-46):
```markdown
## After the Design

**Documentation:**
- Write the validated design to `docs/plans/YYYY-MM-DD-<topic>-design.md`
- Use elements-of-style:writing-clearly-and-concisely skill if available
- Commit the design document to git

**Implementation (if continuing):**
- Ask: "Ready to set up for implementation?"
- Use superpowers:using-git-worktrees to create isolated workspace
- Use superpowers:writing-plans to create detailed implementation plan
```

**Step 2: Replace with OpenSpec-integrated version**

New content:
```markdown
## After the Design

**OpenSpec Integration:**
- Ask: "Do you want to create an OpenSpec change document for this design?"
- If yes, create complete OpenSpec change structure:
  ```
  openspec/changes/<feature-name>/
  ├── proposal.md      # Extract from design discussion (Why, What Changes, Impact)
  ├── design.md        # Technical decisions from design
  ├── tasks.md         # High-level task checklist from design
  ├── plan/            # Empty directory for writing-plans
  └── specs/           # If spec changes needed
  ```

**proposal.md content:**
- `## Why` - Purpose and motivation from discussion
- `## What Changes` - Summary of changes from design
- `## Impact` - Affected code and specifications

**tasks.md content:**
- Break design into high-level tasks
- Use OpenSpec format: `- [ ] N.N Task description`

**Implementation (if continuing):**
- Ask: "Ready to set up for implementation?"
- Use superpowers:using-git-worktrees to create isolated workspace
- Use superpowers:writing-plans to create detailed implementation plan in `openspec/changes/<feature>/plan/`
```

**Step 3: Verify the edit**

Run: Read the modified file and confirm the "After the Design" section is updated correctly.

---

### Task 2: Modify writing-plans skill - Update context and output path

**Files:**
- Modify: `skills/writing-plans/SKILL.md`

**Step 1: Update Overview section (lines 8-18)**

Replace:
```markdown
## Overview

Write comprehensive implementation plans assuming the engineer has zero context for our codebase and questionable taste. Document everything they need to know: which files to touch for each task, code, testing, docs they might need to check, how to test it. Give them the whole plan as bite-sized tasks. DRY. YAGNI. TDD. Frequent commits.

Assume they are a skilled developer, but know almost nothing about our toolset or problem domain. Assume they don't know good test design very well.

**Announce at start:** "I'm using the writing-plans skill to create the implementation plan."

**Context:** This should be run in a dedicated worktree (created by brainstorming skill).

**Save plans to:** `docs/plans/YYYY-MM-DD-<feature-name>.md`
```

With:
```markdown
## Overview

Write comprehensive implementation plans assuming the engineer has zero context for our codebase and questionable taste. Document everything they need to know: which files to touch for each task, code, testing, docs they might need to check, how to test it. Give them the whole plan as bite-sized tasks. DRY. YAGNI. TDD.

Assume they are a skilled developer, but know almost nothing about our toolset or problem domain. Assume they don't know good test design very well.

**Announce at start:** "I'm using the writing-plans skill to create the implementation plan."

**Context:** This should be run in a dedicated worktree (created by brainstorming skill).

**OpenSpec Integration:**
- If OpenSpec change exists, read context from:
  - `openspec/changes/<feature>/proposal.md` - Understand purpose
  - `openspec/changes/<feature>/tasks.md` - Task framework
  - `openspec/changes/<feature>/design.md` - Technical decisions (if exists)
- Save plans to: `openspec/changes/<feature>/plan/YYYY-MM-DD-v<N>.md`
- Auto-detect version number (v1, v2, v3...) based on existing files in plan/

**Fallback (no OpenSpec):**
- Save plans to: `docs/plans/YYYY-MM-DD-<feature-name>.md`
```

**Step 2: Update Bite-Sized Task Granularity section (lines 20-27)**

Replace:
```markdown
## Bite-Sized Task Granularity

**Each step is one action (2-5 minutes):**
- "Write the failing test" - step
- "Run it to make sure it fails" - step
- "Implement the minimal code to make the test pass" - step
- "Run the tests and make sure they pass" - step
- "Commit" - step
```

With:
```markdown
## Bite-Sized Task Granularity

**Each step is one action (2-5 minutes):**
- "Write the failing test" - step
- "Run it to make sure it fails" - step
- "Implement the minimal code to make the test pass" - step
- "Run the tests and make sure they pass" - step

**Note:** Commits are not mandatory per task. Developer decides when to commit.
```

**Step 3: Update Plan Document Header (lines 29-45)**

Replace:
```markdown
## Plan Document Header

**Every plan MUST start with this header:**

```markdown
# [Feature Name] Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** [One sentence describing what this builds]

**Architecture:** [2-3 sentences about approach]

**Tech Stack:** [Key technologies/libraries]

---
```
```

With:
```markdown
## Plan Document Header

**Every plan MUST start with this header:**

```markdown
# [Feature Name] Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**OpenSpec Change:** `openspec/changes/<feature-name>/` (if applicable)

**Goal:** [One sentence describing what this builds - from proposal.md if available]

**Architecture:** [2-3 sentences about approach - from design.md if available]

**Tech Stack:** [Key technologies/libraries]

---
```
```

**Step 4: Update Task Structure - remove commit step (lines 47-88)**

Replace the task structure example to remove the commit step:
```markdown
## Task Structure

```markdown
### Task N: [Component Name]

**Files:**
- Create: `exact/path/to/file.py`
- Modify: `exact/path/to/existing.py:123-145`
- Test: `tests/exact/path/to/test.py`

**Step 1: Write the failing test**

```python
def test_specific_behavior():
    result = function(input)
    assert result == expected
```

**Step 2: Run test to verify it fails**

Run: `pytest tests/path/test.py::test_name -v`
Expected: FAIL with "function not defined"

**Step 3: Write minimal implementation**

```python
def function(input):
    return expected
```

**Step 4: Run test to verify it passes**

Run: `pytest tests/path/test.py::test_name -v`
Expected: PASS
```
```

**Step 5: Update Remember section (lines 90-95)**

Replace:
```markdown
## Remember
- Exact file paths always
- Complete code in plan (not "add validation")
- Exact commands with expected output
- Reference relevant skills with @ syntax
- DRY, YAGNI, TDD, frequent commits
```

With:
```markdown
## Remember
- Exact file paths always
- Complete code in plan (not "add validation")
- Exact commands with expected output
- Reference relevant skills with @ syntax
- DRY, YAGNI, TDD
- Read OpenSpec context first if available
```

**Step 6: Update Execution Handoff section (lines 97-116)**

Replace:
```markdown
## Execution Handoff

After saving the plan, offer execution choice:

**"Plan complete and saved to `docs/plans/<filename>.md`. Two execution options:**
```

With:
```markdown
## Execution Handoff

After saving the plan, offer execution choice:

**"Plan complete and saved to `openspec/changes/<feature>/plan/<filename>.md` (or `docs/plans/<filename>.md` if no OpenSpec). Two execution options:**
```

**Step 7: Verify all edits**

Run: Read the modified file and confirm all sections are updated correctly.

---

### Task 3: Modify executing-plans skill - Add OpenSpec context reading and tasks.md sync

**Files:**
- Modify: `skills/executing-plans/SKILL.md`

**Step 1: Update Overview section (lines 8-14)**

Replace:
```markdown
## Overview

Load plan, review critically, execute tasks in batches, report for review between batches.

**Core principle:** Batch execution with checkpoints for architect review.

**Announce at start:** "I'm using the executing-plans skill to implement this plan."
```

With:
```markdown
## Overview

Load plan, review critically, execute tasks in batches, report for review between batches.

**Core principle:** Batch execution with checkpoints for architect review.

**Announce at start:** "I'm using the executing-plans skill to implement this plan."

**OpenSpec Integration:**
- If plan is in `openspec/changes/<feature>/plan/`, read full context first:
  - `proposal.md` - Understand "why"
  - `tasks.md` - High-level task overview
  - `design.md` - Technical decisions (if exists)
- Select latest plan version from plan/ directory (by date and version number)
- Announce: "Reading OpenSpec change context from `openspec/changes/<name>/`..."
```

**Step 2: Update Step 1: Load and Review Plan (lines 16-22)**

Replace:
```markdown
### Step 1: Load and Review Plan
1. Read plan file
2. Review critically - identify any questions or concerns about the plan
3. If concerns: Raise them with your human partner before starting
4. If no concerns: Create TodoWrite and proceed
```

With:
```markdown
### Step 1: Load and Review Plan

**If OpenSpec change exists:**
1. Read `openspec/changes/<feature>/proposal.md` - understand purpose
2. Read `openspec/changes/<feature>/tasks.md` - understand high-level tasks
3. Read `openspec/changes/<feature>/design.md` - understand technical decisions (if exists)
4. Read latest plan from `openspec/changes/<feature>/plan/` (sort by date + version)

**Then:**
1. Review plan critically - identify any questions or concerns
2. If concerns: Raise them with your human partner before starting
3. If no concerns: Create TodoWrite and proceed
```

**Step 3: Update Step 3: Report (lines 33-37)**

Replace:
```markdown
### Step 3: Report
When batch complete:
- Show what was implemented
- Show verification output
- Say: "Ready for feedback."
```

With:
```markdown
### Step 3: Report
When batch complete:
- **Update tasks.md:** Mark corresponding high-level tasks as complete `[x]`
  - Plan Task N corresponds to tasks.md section N.x
  - After completing Task N, mark all N.x tasks in tasks.md as `[x]`
- Show what was implemented
- Show verification output
- Say: "Ready for feedback."
```

**Step 4: Update Step 5: Complete Development (lines 45-50)**

Replace:
```markdown
### Step 5: Complete Development

After all tasks complete and verified:
- Announce: "I'm using the finishing-a-development-branch skill to complete this work."
- **REQUIRED SUB-SKILL:** Use superpowers:finishing-a-development-branch
- Follow that skill to verify tests, present options, execute choice
```

With:
```markdown
### Step 5: Complete Development

After all tasks complete and verified:
- **If OpenSpec change:** Ensure all tasks in tasks.md are marked `[x]`
- **If OpenSpec change:** Announce: "All tasks complete. Run `openspec archive <change-name>` to archive this change."
- Announce: "I'm using the finishing-a-development-branch skill to complete this work."
- **REQUIRED SUB-SKILL:** Use superpowers:finishing-a-development-branch
- Follow that skill to verify tests, present options, execute choice
```

**Step 5: Verify all edits**

Run: Read the modified file and confirm all sections are updated correctly.

---

### Task 4: Verify integrated workflow

**Step 1: Review all three modified skill files**

Read each file and verify:
- brainstorming: Has OpenSpec prompt flow after design
- writing-plans: Reads OpenSpec context, outputs to plan/, no forced commits
- executing-plans: Reads context, syncs tasks.md, prompts archive

**Step 2: Verify OpenSpec change structure is complete**

Check that `openspec/changes/integrate-openspec-workflow/` contains:
- proposal.md
- design.md
- tasks.md
- plan/ directory

**Step 3: Mark documentation task complete**

Update tasks.md to mark task 4.1 as complete.
