# Brainstorming Source Collection Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Add a source collection phase to the brainstorming skill when invoked without arguments.

**Architecture:** Modify SKILL.md to add a new section describing the source collection flow. The skill instructs Claude to use AskUserQuestion for collecting Jira/API/Figma URLs, call MCP services for summaries, create sources.md, then proceed to normal brainstorming.

**Tech Stack:** Markdown (SKILL.md), MCP tools (apifox-mcp, figmap-mcp)

**OpenSpec Change:** `openspec/changes/brainstorming-source-collection/`

---

### Task 1: Add Source Collection Section to SKILL.md

**Files:**
- Modify: `skills/brainstorming/SKILL.md:5-12` (insert new section after Overview)

**Step 1: Read current SKILL.md structure**

Verify the file structure before making changes.

**Step 2: Insert new section after "## Overview"**

Add the following content after line 12 (after the Overview section, before "## The Process"):

```markdown
## No-Argument Invocation - Source Collection

When `/superpowers:brainstorm` is invoked without any arguments, first collect information sources:

**Step 1: Collect Information Sources**

Use AskUserQuestion to ask for the following (user can provide URL or skip):
- Jira URL (optional)
- API endpoint URL - Apifox (can skip)
- Figma URL (can skip)

**Step 2: Request Requirements Description (if needed)**

If user did not provide Jira URL, ask:
- What problem are you trying to solve?
- What functionality do you expect?

**Step 3: Fetch MCP Information**

- If API URL provided, call apifox-mcp to get API summary
- If Figma URL provided, call figmap-mcp to get design summary
- On failure: log reason and continue (don't block)

**Step 4: Determine feature-name**

Determine feature name from these sources (priority high to low):
1. Jira ticket title
2. Keywords from user description
3. Ask user

**Step 5: Create sources.md**

Create `sources.md` in `openspec/changes/<feature-name>/` directory with this format:

```markdown
# <Feature Name> - Sources

## Information Sources

| Type | Link |
|------|------|
| Jira | <url or "Not provided"> |
| API (Apifox) | <url or "Not provided"> |
| Figma | <url or "Not provided"> |

## PRD Description

<Description from Jira or manually provided by user>

## API Summary

> Source: apifox-mcp

<API summary or "⚠️ Failed to fetch - <reason>">

## Design Summary

> Source: figmap-mcp

<Design summary or "⚠️ Failed to fetch - <reason>">

---
*This file is auto-generated by brainstorming skill for document consistency verification*
```

**Step 6: Enter Normal Brainstorming Flow**

With collected context (PRD description, API summary, design summary), proceed to "The Process" section below.
```

**Step 3: Verify the edit**

Read the modified file and verify:
- New section appears after Overview
- Markdown formatting is correct
- All steps are clearly documented

---

### Task 2: Update OpenSpec Integration Section

**Files:**
- Modify: `skills/brainstorming/SKILL.md:35-47` (OpenSpec Integration section)

**Step 1: Update the directory structure to include sources.md**

Find the OpenSpec change structure in the file and update it to include `sources.md`:

Change:
```markdown
  openspec/changes/<feature-name>/
  ├── proposal.md      # Extract from design discussion (Why, What Changes, Impact)
  ├── design.md        # Technical decisions from design
  ├── tasks.md         # High-level task checklist from design
  ├── plan/            # Empty directory for writing-plans
  └── specs/           # If spec changes needed
```

To:
```markdown
  openspec/changes/<feature-name>/
  ├── sources.md       # Information sources and PRD (generated by source collection phase)
  ├── proposal.md      # Extract from design discussion (Why, What Changes, Impact)
  ├── design.md        # Technical decisions from design
  ├── tasks.md         # High-level task checklist from design
  ├── plan/            # Empty directory for writing-plans
  └── specs/           # If spec changes needed
```

**Step 2: Verify the edit**

Read the modified section and confirm sources.md is included in the structure.

---

### Task 3: Add Key Principle for Source Collection

**Files:**
- Modify: `skills/brainstorming/SKILL.md:63-70` (Key Principles section)

**Step 1: Add new principle about source collection**

Add a new bullet point to Key Principles:

```markdown
- **Source collection first** - When no arguments provided, collect Jira/API/Figma sources before exploring ideas
```

**Step 2: Verify the edit**

Confirm the new principle appears in the list.

---

### Task 4: Verify Complete SKILL.md

**Files:**
- Read: `skills/brainstorming/SKILL.md`

**Step 1: Read entire file**

Read the complete modified SKILL.md to verify all changes are correct.

**Step 2: Verify structure**

Confirm the file has this structure:
1. Frontmatter (name, description)
2. `# Brainstorming Ideas Into Designs`
3. `## Overview`
4. `## No-Argument Invocation - Source Collection` (NEW)
5. `## The Process`
6. `## After the Design` (with updated structure)
7. `## Key Principles` (with new principle)

**Step 3: Report completion**

Summarize all changes made.

---

### Task 5: Update tasks.md Status

**Files:**
- Modify: `openspec/changes/brainstorming-source-collection/tasks.md`

**Step 1: Mark completed tasks**

Update task checkboxes to reflect completion:
- [x] 1.1 through 1.8
- [x] 2.4 (sources.md structure verified)

Note: Tasks 2.1-2.3 are runtime verification tasks that cannot be pre-tested.
